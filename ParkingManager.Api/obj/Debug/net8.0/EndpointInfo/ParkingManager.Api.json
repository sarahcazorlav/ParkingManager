{
  "openapi": "3.0.4",
  "info": {
    "title": "ParkingManager API",
    "description": "API para gestión de estacionamientos",
    "contact": {
      "name": "Equipo de Desarrollo",
      "email": "desarrollo@parkingmanager.com"
    },
    "version": "v1"
  },
  "paths": {
    "/api/Disponibilidad": {
      "post": {
        "tags": [
          "Disponibilidad"
        ],
        "summary": "Crea una nueva disponibilidad de espacio",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Disponibilidad"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Disponibilidad"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Disponibilidad"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Disponibilidad/zona/{zona}": {
      "get": {
        "tags": [
          "Disponibilidad"
        ],
        "summary": "Obtiene solo los espacios disponibles en una zona específica, ejemplo: ZonaA",
        "parameters": [
          {
            "name": "zona",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Disponibilidad/rango-fechas": {
      "post": {
        "tags": [
          "Disponibilidad"
        ],
        "summary": "Obtiene la disponibilidad de todos los espacios en un rango de fechas",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DisponibilidadRangoRequestDto"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/DisponibilidadRangoRequestDto"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/DisponibilidadRangoRequestDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Disponibilidad/disponibles/rango-fechas": {
      "post": {
        "tags": [
          "Disponibilidad"
        ],
        "summary": "Obtiene solo los espacios disponibles en un rango de fechas",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DisponibilidadRangoRequestDto"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/DisponibilidadRangoRequestDto"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/DisponibilidadRangoRequestDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Registro/entrada": {
      "post": {
        "tags": [
          "Registro"
        ],
        "summary": "Registra la entrada de un vehículo al estacionamiento",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Registro"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Registro"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Registro"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Registro/salida/{id}": {
      "put": {
        "tags": [
          "Registro"
        ],
        "summary": "Registra la salida de un vehículo del estacionamiento",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Registro/{id}": {
      "get": {
        "tags": [
          "Registro"
        ],
        "summary": "Obtiene un registro por su ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Security/register": {
      "post": {
        "tags": [
          "Security"
        ],
        "summary": "Registra un nuevo usuario en el sistema",
        "requestBody": {
          "description": "Datos del usuario",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SecurityDto"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/SecurityDto"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/SecurityDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Security/me": {
      "get": {
        "tags": [
          "Security"
        ],
        "summary": "Obtiene información del usuario autenticado (requiere token)",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Tarifa": {
      "get": {
        "tags": [
          "Tarifa"
        ],
        "summary": "Obtiene todas las tarifas con filtros opcionales",
        "parameters": [
          {
            "name": "TipoVehiculo",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Activo",
            "in": "query",
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "PageSize",
            "in": "query",
            "description": "Cantidad de registros por pagina",
            "schema": {
              "type": "integer",
              "description": "Cantidad de registros por pagina",
              "format": "int32"
            }
          },
          {
            "name": "PageNumber",
            "in": "query",
            "description": "Numero de página a mostrar",
            "schema": {
              "type": "integer",
              "description": "Numero de página a mostrar",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "tags": [
          "Tarifa"
        ],
        "summary": "Crea una nueva tarifa",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tarifa"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Tarifa"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Tarifa"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Tarifa/{id}": {
      "get": {
        "tags": [
          "Tarifa"
        ],
        "summary": "Obtiene una tarifa por su ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "put": {
        "tags": [
          "Tarifa"
        ],
        "summary": "Actualiza una tarifa existente",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tarifa"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Tarifa"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Tarifa"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/TestDb/check": {
      "get": {
        "tags": [
          "TestDb"
        ],
        "summary": "Verifica la conexión con la base de datos",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Token/test-connection": {
      "get": {
        "tags": [
          "Token"
        ],
        "summary": "Autentica un usuario y genera un token JWT",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Token": {
      "post": {
        "tags": [
          "Token"
        ],
        "summary": "Autentica un usuario y genera un token JWT",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserLogin"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/UserLogin"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/UserLogin"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Token/config": {
      "get": {
        "tags": [
          "Token"
        ],
        "summary": "Endpoint de prueba para verificar la configuración",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Usuario": {
      "get": {
        "tags": [
          "Usuario"
        ],
        "summary": "Obtiene la lista de usuarios con filtros y paginación.",
        "parameters": [
          {
            "name": "Nombre",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Email",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Rol",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Activo",
            "in": "query",
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "PageSize",
            "in": "query",
            "description": "Cantidad de registros por pagina",
            "schema": {
              "type": "integer",
              "description": "Cantidad de registros por pagina",
              "format": "int32"
            }
          },
          {
            "name": "PageNumber",
            "in": "query",
            "description": "Numero de página a mostrar",
            "schema": {
              "type": "integer",
              "description": "Numero de página a mostrar",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "tags": [
          "Usuario"
        ],
        "summary": "Crea un nuevo usuario.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Usuario"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Usuario"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Usuario"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Usuario/{id}": {
      "get": {
        "tags": [
          "Usuario"
        ],
        "summary": "Obtiene un usuario por su ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "put": {
        "tags": [
          "Usuario"
        ],
        "summary": "Actualiza un usuario existente.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Usuario"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Usuario"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Usuario"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "delete": {
        "tags": [
          "Usuario"
        ],
        "summary": "Elimina un usuario por ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v{version}/usuario": {
      "get": {
        "tags": [
          "UsuarioV"
        ],
        "summary": "Obtiene usuarios (Versión 2 - Mejorada con información adicional)",
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v{version}/usuario/{id}": {
      "get": {
        "tags": [
          "UsuarioV"
        ],
        "summary": "Obtiene un usuario por ID (V2)",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "version",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Vehiculo": {
      "post": {
        "tags": [
          "Vehiculo"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Vehiculo"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Vehiculo"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Vehiculo"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/Vehiculo/{id}": {
      "get": {
        "tags": [
          "Vehiculo"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Disponibilidad": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "format": "int32"
          },
          "TipoEspacio": {
            "type": "string",
            "nullable": true
          },
          "NumeroEspacio": {
            "type": "string",
            "nullable": true
          },
          "Piso": {
            "type": "integer",
            "format": "int32"
          },
          "Ocupado": {
            "type": "boolean"
          },
          "FechaActualizacion": {
            "type": "string",
            "format": "date-time"
          },
          "Registros": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Registro"
            },
            "nullable": true
          },
          "Estado": {
            "type": "string",
            "nullable": true
          },
          "Zona": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "DisponibilidadRangoRequestDto": {
        "type": "object",
        "properties": {
          "DiaInicio": {
            "type": "integer",
            "format": "int32"
          },
          "MesInicio": {
            "type": "integer",
            "format": "int32"
          },
          "AnioInicio": {
            "type": "integer",
            "format": "int32"
          },
          "DiaFinal": {
            "type": "integer",
            "format": "int32"
          },
          "MesFinal": {
            "type": "integer",
            "format": "int32"
          },
          "AnioFinal": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false
      },
      "Registro": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "format": "int32"
          },
          "VehiculoId": {
            "type": "integer",
            "format": "int32"
          },
          "EspacioId": {
            "type": "integer",
            "format": "int32"
          },
          "FechaEntrada": {
            "type": "string",
            "format": "date-time"
          },
          "FechaSalida": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "TiempoEstadia": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "MontoTotal": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "Estado": {
            "type": "string",
            "nullable": true
          },
          "Zona": {
            "type": "string",
            "nullable": true
          },
          "Fecha": {
            "type": "string",
            "format": "date-time"
          },
          "Vehiculo": {
            "$ref": "#/components/schemas/Vehiculo"
          },
          "Espacio": {
            "$ref": "#/components/schemas/Disponibilidad"
          }
        },
        "additionalProperties": false
      },
      "RoleType": {
        "enum": [
          0,
          1,
          2
        ],
        "type": "integer",
        "format": "int32"
      },
      "SecurityDto": {
        "type": "object",
        "properties": {
          "Login": {
            "type": "string",
            "nullable": true
          },
          "Password": {
            "type": "string",
            "nullable": true
          },
          "Name": {
            "type": "string",
            "nullable": true
          },
          "Role": {
            "$ref": "#/components/schemas/RoleType"
          }
        },
        "additionalProperties": false
      },
      "Tarifa": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "format": "int32"
          },
          "TipoVehiculo": {
            "type": "string",
            "nullable": true
          },
          "TarifaPorHora": {
            "type": "number",
            "format": "double"
          },
          "TarifaPorDia": {
            "type": "number",
            "format": "double"
          },
          "Descripcion": {
            "type": "string",
            "nullable": true
          },
          "Activo": {
            "type": "boolean"
          },
          "FechaCreacion": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": false
      },
      "UserLogin": {
        "type": "object",
        "properties": {
          "User": {
            "type": "string",
            "nullable": true
          },
          "Password": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "Usuario": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "format": "int32"
          },
          "Password": {
            "type": "string",
            "nullable": true
          },
          "Nombre": {
            "type": "string",
            "nullable": true
          },
          "Apellido": {
            "type": "string",
            "nullable": true
          },
          "Email": {
            "type": "string",
            "nullable": true
          },
          "Username": {
            "type": "string",
            "nullable": true
          },
          "Telefono": {
            "type": "string",
            "nullable": true
          },
          "Rol": {
            "type": "string",
            "nullable": true
          },
          "FechaRegistro": {
            "type": "string",
            "format": "date-time"
          },
          "Activo": {
            "type": "boolean"
          },
          "Vehiculos": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Vehiculo"
            },
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "Vehiculo": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "format": "int32"
          },
          "IdUsuario": {
            "type": "integer",
            "format": "int32"
          },
          "Placa": {
            "type": "string",
            "nullable": true
          },
          "Marca": {
            "type": "string",
            "nullable": true
          },
          "Modelo": {
            "type": "string",
            "nullable": true
          },
          "Color": {
            "type": "string",
            "nullable": true
          },
          "TipoVehiculo": {
            "type": "string",
            "nullable": true
          },
          "FechaRegistro": {
            "type": "string",
            "format": "date-time"
          },
          "Activo": {
            "type": "boolean"
          },
          "Usuario": {
            "$ref": "#/components/schemas/Usuario"
          },
          "Registros": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Registro"
            },
            "nullable": true
          }
        },
        "additionalProperties": false
      }
    },
    "securitySchemes": {
      "Bearer": {
        "type": "http",
        "description": "Ingrese 'Bearer' [espacio] y luego su token JWT",
        "scheme": "Bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "security": [
    {
      "Bearer": [ ]
    }
  ]
}